# HR-ассистент на базе ИИ

Этот проект представляет собой RAG (Retrieval-Augmented Generation) систему, реализованную в виде веб-приложения Streamlit, предназначенную для автоматического ответа на вопросы по внутренней политике компании на основе загруженных HR-документов. Включает в себя компоненты для оценки и A/B тестирования производительности системы.

## Особенности

- **RAG-система**: Извлекает информацию из документов и генерирует ответы, опираясь на найденный контекст.
- **Интерфейс Streamlit**: Простой в использовании чат-интерфейс для взаимодействия с ИИ-ассистентом.
- **Оценка качества**: Интеграция с LangSmith для автоматической оценки ответов по метрикам корректности, обоснованности, релевантности и релевантности поиска.
- **A/B тестирование**: Возможность сравнения производительности различных версий RAG-системы (например, с разным количеством retrieved документов `k`).
- **Безопасность и точность**: Система настроена на строгое следование контексту и избегание галлюцинаций.

## Технологии

- **Python 3.x**
- **LangChain** — для оркестровки LLM и RAG-логики
- **HuggingFace Embeddings** — для генерации эмбеддингов документов
- **FAISS** — для векторного поиска
- **OpenRouter** — для доступа к LLM (Mistral, Gemini)
- **Streamlit** — для веб-интерфейса
- **LangSmith** — для оценки и A/B тестирования
- **Pydantic** — для структурированного вывода LLM

## Структура проекта

- rag_core.py
- app.py
- evaluate_rag.py
- run_evaluation.py
- .env
- data/

## Установка и запуск

1. **Клонируйте репозиторий**:

    ```bash
    git clone <URL_ВАШЕГО_РЕПОЗИТОРИЯ>
    cd <НАЗВАНИЕ_ПРОЕКТА>
    ```

2. **Создайте и активируйте виртуальное окружение (рекомендуется)**:

    ```bash
    python -m venv venv
    source venv/bin/activate  # Linux/macOS
    # или
    venv\Scripts\activate     # Windows
    ```

3. **Установите зависимости**:

    > `pip install -r requirements.txt`

4. **Настройте переменные окружения**:

    - Создайте файл `.env` в корне проекта.
    - Добавьте ваш API-ключ OpenRouter:

      ```env
      OPENROUTER_API_KEY=your_openrouter_api_key_here
      # LANGSMITH_API_KEY=your_langsmith_api_key_here (если планируете использовать LangSmith)
      # LANGSMITH_TRACING=true (если планируете использовать LangSmith)
      ```

5. **Подготовьте HR-документы**:

    - Поместите ваш HR-документ (например, `hr_policy.txt`) в директорию `data/`. Убедитесь, что имя файла соответствует значению по умолчанию в `rag_core.py` или измените его при инициализации ``.

6. **Запустите веб-приложение**:

    ```bash
    streamlit run app.py
    ```
    Приложение откроется в браузере по адресу `http://localhost:8501`.

## Запуск оценки и A/B тестирования

1. Убедитесь, что у вас настроены API-ключи для LangSmith (если используется) и OpenRouter.
2. Убедитесь, что у вас есть датасет в LangSmith с вопросами и эталонными ответами.
3. Запустите скрипт `run_evaluation.py`, указав правильный `dataset_id` и инициализировав нужные версии RAG-системы для сравнения.

    ```bash
    python run_evaluation.py
    ```

## Настройка

- `rag_core.py`: Настройте `file_path`, `k` (количество retrieved фрагментов), `embedding_model`, `llm_model`, `temperature`, `max_tokens` в конструкторе `HrRAG`.
- `app.py`: Можно настроить заголовок, описание и приветственное сообщение.
- `evaluate_rag.py`: Настройте логику оценки и модели, используемые для грейдинга, если необходимо.
